{
  "name": "generate_excel_file",
  "parameters": {
    "type": "object",
    "required": ["sheetsData"],
    "properties": {
      "sheetsData": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["sheetName", "tables"],
          "properties": {
            "tables": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["startCell", "columns", "rows"],
                "properties": {
                  "rows": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "oneOf": [
                        {
                          "type": "string",
                          "description": "A static value (string or number) to be placed directly in the cell. No calculations or references to other cells."
                        },
                        {
                          "type": "object",
                          "properties": {
                            "formula": {
                              "type": "string",
                              "description": "A formula to be applied to the cell (not begin with '='). It must not include static values as string or number. Ensure that any cell ranges used in the formula must not include cells of table header and table title. For example, if the table starts at A1 with a title in row 1 and header in row 2, a valid formula would be 'SUM(A3:A10)', summing data from rows 3 to 10. Avoid creating circular references where a formula directly or indirectly references its own cell."
                            }
                          },
                          "required": ["formula"]
                        }
                      ],
                      "description": "Each row item can contain either a static value (string or number) or a formula. Make sure it's length same as defined columns length."
                    },
                    "required": ["rows"],
                    "description": "Array of rows in the table, where each row contains either static values or formulas for the cells. If the value is static, it should be represented as a single string. If the value is a formula, it should be represented as an object with a 'formula' property."
                  },
                  "title": {
                    "type": "string",
                    "example": "Q1 Sales Data",
                    "description": "The title of the table, which will be displayed in the first row."
                  },
                  "columns": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["name", "type"],
                      "properties": {
                        "name": {
                          "type": "string",
                          "example": "Product Name",
                          "description": "The name of the column."
                        },
                        "type": {
                          "enum": ["string", "number", "boolean", "percent", "currency", "date"],
                          "type": "string",
                          "example": "string",
                          "description": "The data type of the column."
                        },
                        "format": {
                          "type": "string",
                          "example": "$#,##0",
                          "description": "The format of the column (e.g., '0.00%', '$#,##0', etc.)."
                        }
                      }
                    },
                    "description": "The list of columns in the table, each with a name, type, and optional format."
                  },
                  "startCell": {
                    "type": "string",
                    "example": "A1",
                    "description": "The starting cell (e.g., 'A1') where the table will begin."
                  },
                  "skipHeader": {
                    "type": "boolean",
                    "example": false,
                    "description": "Whether to skip the header row for this table."
                  }
                }
              },
              "description": "The tables to include in the sheet."
            },
            "sheetName": {
              "type": "string",
              "example": "Sales Data",
              "description": "The name of the sheet to be created in the Excel file."
            }
          }
        },
        "description": "An array of sheet data, where each sheet contains a name and an array of tables to generate."
      }
    }
  },
  "description": "Generate an Excel file (.xlsx) and return the URL for downloading it. If the download URL is not present in the response, inform the user that the Excel file could not be generated. Prompt the user to verify that the correct plugin server URL is being used."
}
